# Лабораторная работа №4. Анализ и расширенная визуализация данных в Zabbix

 - **Калинкова София, I2302** 
 - **12.11.2025** 

## Цель работы

Ознакомление с расширенными возможностями платформы Zabbix: создание графиков и отчётов, использование сложных элементов (item), корреляция метрик и оптимизация системы мониторинга.

## Задачи:

1. Использовать зависимые (dependent) и вычисляемые (calculated) элементы данных.
2. Настраивать шаблоны (templates) для групп хостов.
3. Создавать пользовательские графики и автоматические отчёты.
4. Интерпретировать и сопоставлять собранные данные (например, CPU + память + сеть).
5. Настраивать условные оповещения по нескольким критериям.
6. Оптимизировать параметры сбора данных и уведомлений.

## Необходимое оборудование и программное обеспечение:

• Рабочий сервер Zabbix (установленный на предыдущей лабораторной работе).
• Как минимум один хост с активным Zabbix Agent.
• Доступ к веб-интерфейсу Zabbix с правами администратора.

## Ход работы:

### 1. Создание собственного шаблона

1.1 Переходим в раздел шаблонов: `data collection → Templates → Create template`

1.2. Заполняем форму:

- Template name: `Template IT-System-Monitoring`
- Groups: выбераем `Templates` 
- Нажимаем: `Add`

![alt text](img/image.png)

1.3 Добавление элементов данных 

Мы создали в шаблоне Template `IT-System-Monitoring` несколько ключевых элементов данных (items), необходимых для базового мониторинга состояния хоста.
Были добавлены следующие метрики:

- CPU Load (avg1, avg5, avg15) — показывает среднюю загрузку процессора за 1, 5 и 15 минут. Эти показатели позволяют определить, как изменяется нагрузка на систему со временем и нет ли перегрузки.

![alt text](img/image-1.png)
![alt text](img/image-2.png)

- RAM Used % — отображает процент использования оперативной памяти, что помогает отслеживать наличие утечек памяти или нехватку ресурсов.

![alt text](img/image-3.png)

- Disk Space Used % — фиксирует уровень заполнения дискового пространства, что позволяет заранее реагировать на нехватку свободного места.

![alt text](img/image-4.png)

- Network Traffic (in/out) — измеряет объём входящего и исходящего сетевого трафика, помогая анализировать активность сети и выявлять аномалии в передаче данных.

![alt text](img/image-5.png)
![alt text](img/image-6.png)
![alt text](img/image-7.png)

![alt text](img/image-8.png)

1.4 Добавление триггера

Далее мы добавили триггер “High load”, который срабатывает, если параметр
system.cpu.load[all,avg1] > 2 на протяжении более 5 минут.
Такой триггер позволяет вовремя обнаруживать перегрузку процессора и уведомлять администратора о потенциальных проблемах в работе системы.

![alt text](img/image-9.png)
![alt text](img/image-10.png)
![alt text](img/image-11.png)

![alt text](img/image-12.png)

### 2. Применение шаблона к хосту

Созданный шаблон `Template IT-System-Monitoring` был привязан к хосту `agent-vm` через меню `Configuration → Hosts → Templates → Link new templates`. 

![alt text](img/image-13.png)

На хосте `agent-vm` был создан вычисляемый элемент (calculated item) — RAM/CPU ratio, который показывает отношение процента используемой оперативной памяти к средней загрузке процессора за 5 минут. 

В расчёте используются элементы `ram.used.pct и system.cpu.load[all,avg5]`, 

а формула имеет вид:
`last(//ram.used.pct) / last(//system.cpu.load[all,avg5])`.
Элемент обновляется каждые 30–60 секунд и позволяет быстро оценивать соотношение нагрузки на память и CPU.

• Создание dependent item.

![alt text](img/image-22.png)
![alt text](img/image-24.png)

Также был создан зависимый элемент (dependent item), извлекающий только числовые данные из текстового параметра uptime. 

Для этого в блоке Preprocessing применена регулярная маска (\d+), а на выходе задано $1, что позволяет получать только числовое значение времени работы системы. Такой подход упрощает анализ данных и их дальнейшую обработку в Zabbix.

### 4. Визуализация и дашборды

• График, отображающий совместную динамику CPU и RAM.
Создание графика CPU/RAM

Переходим в: `Configuration → Hosts → agent-vm → Graphs → Create graph`

Заполни поля:

- Name: CPU & RAM usage
- Graph type: Normal

Добаляем элементы:

- Item: CPU Load avg5
- Type of graph item: Line


    - Item: RAM Used %
    - Type of graph item: Line

Сохраням Add

Теперь у тебя есть график, показывающий динамику CPU и RAM одновременно.

![alt text](img/image-25.png)

Затем был создан Dashboard для централизованного контроля состояния системы. В него добавлены несколько виджетов:

![alt text](img/image-26.png)

- График, созданный ранее, CPU & RAM usage — визуализирует динамику основных ресурсов;.

![alt text](img/image-28.png)

• Top 5 CPU Load — отображает хосты с наибольшей загрузкой процессора, что помогает определить самые нагруженные системы;

![alt text](img/image-32.png)

Настройка колонок

![alt text](img/image-31.png)

• Сводка по тревогам (alert summary).

![alt text](img/image-33.png)

На дашборд был добавлен виджет `Alert summary`, предназначенный для отображения текущих и недавних проблем на хосте `agent-vm`. При создании выбран тип Problems, установлен интервал обновления 60 секунд и фильтрация по группам Linux servers.

Виджет показывает активные тревоги, их уровень серьёзности (от Warning до Disaster), дату последнего изменения и краткое описание проблемы. Также включено отображение временной шкалы (Show timeline), что позволяет визуально отслеживать продолжительность каждой тревоги.

![alt text](img/image-34.png)

### 5. Условные оповещения и действия

- Настройте действие, которое отправляет уведомление только если:
- CPU Load > 2 и RAM Used > 80%.
- Используйте логические выражения (AND, OR) в настройках триггера.

![alt text](img/image-37.png)

Так как требовалось, чтобы оба условия выполнялись одновременно, мы использовали логическое выражение AND в конструкторе триггера. Это позволило сделать условие более точным

Сохранили триггер.


Переходим в Allerts → trigger Actions → Create action
![alt text](img/image-38.png)


![alt text](img/image-39.png)
![alt text](img/image-40.png)
![alt text](img/image-41.png)
![alt text](img/image-42.png)

После этого было создано действие (Action) с названием Notify on high CPU & RAM. Оно связано именно с этим триггером и выполняет операцию Send message, отправляя уведомление пользователю Admin (Zabbix Administrator) по всем доступным каналам связи. Дополнительные операции (восстановление, обновление и т. д.) не настраивались, чтобы оставить логику простой и понятной.

В результате уведомление отправляется только тогда, когда одновременно превышены оба порога — CPU > 2 и RAM > 80%. Это позволяет избежать лишних тревог

### 6. Экспорт и документирование

На завершающем этапе работы был выполнен экспорт созданного шаблона Template IT-System-Monitoring. В интерфейсе Zabbix, через раздел Configuration → Templates, выбран шаблон, применённый к хосту agent-vm, и экспортирован в формате XML с помощью кнопки Export. Этот файл можно использовать для быстрого восстановления шаблона или переноса настроек на другой сервер.

![alt text](img/image-43.png)
![alt text](img/image-44.png)
Также был проверен журнал событий (Monitoring → Problems). За последний час система не зафиксировала проблем — сообщение `No data found. Displaying 0 of 0 found` означает отсутствие зарегистрированных проблем за выбранный промежуток времени. Это свидетельствует о стабильной работе хоста и корректной настройке мониторинга.

![alt text](img/image-45.png)

## Контрольные вопросы
**1. В чём разница между элементами dependent и calculated?**

- Dependent (зависимый элемент) — не собирает данные напрямую с хоста. Он получает их из основного элемента данных (master item), используя его результат и обрабатывая через preprocessing. Это снижает нагрузку на агент и сеть.

- Calculated (вычисляемый элемент) — вычисляет значения на основе формул и других элементов данных, используя выражения (например, last("cpu.user")+last("cpu.system")). Он не требует мастер-элемента, а использует данные, уже сохранённые в системе.

**2. Как можно сопоставлять значения нескольких метрик на одном графике?**

Для этого можно использовать графики с несколькими элементами данных (multiple items).
В настройках графика добавляются несколько метрик (например, CPU load, memory usage), и они отображаются на одной оси времени. Это позволяет сравнивать тенденции разных параметров одного хоста или нескольких хостов на одной диаграмме.

**3. Почему стоит использовать шаблоны вместо ручной настройки хостов?**

Шаблоны позволяют:
- Быстро применять одинаковые элементы данных, триггеры, графики и правила к множеству хостов.
- Упростить администрирование и исключить ошибки при ручной настройке.
- Обеспечить единообразие и централизованное обновление мониторинга — изменения в шаблоне автоматически применяются ко всем связанным хостам.

Таким образом, использование шаблонов делает систему мониторинга масштабируемой и удобной в сопровождении.

**4. Как влияет интервал обновления данных (update interval) на производительность системы?**

Интервал обновления определяет, как часто Zabbix опрашивает элементы данных.

Если интервал слишком маленький — система собирает данные слишком часто, что повышает нагрузку на сервер Zabbix, сеть и агентов.

Если слишком большой — данные обновляются редко, и мониторинг теряет актуальность.
Поэтому важно выбирать оптимальный баланс между частотой обновления и производительностью системы.
системы?

## Вывод 

В ходе лабораторной работы была настроена система мониторинга ИТ-инфраструктуры с использованием платформы Zabbix. Были созданы шаблоны с зависимыми и вычисляемыми элементами данных, настроены триггеры, графики и дашборды для визуализации показателей работы хоста agent-vm. Также реализованы условные оповещения, что позволило автоматизировать процесс контроля состояния системы.

Результаты мониторинга показали стабильную работу хоста и корректность выполненных настроек. Полученные навыки позволяют эффективно применять Zabbix для централизованного наблюдения, анализа и оптимизации работы серверов и сервисов в ИТ-инфраструктуре.